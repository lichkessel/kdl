<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">

<!--link rel="import" href="../bower_components/iron-fit-behavior/iron-fit-behavior.html"-->

<link rel="import" href="./shared-styles.html">

<dom-module id="class-list">
  <template>
    <style include="shared-styles"></style>
    <style>

    </style>

    <iron-ajax id="ajax"
      url="http://api.kdl.co.il:7999/classes" 
      last-response="{{classes}}" 
      last-error="{{error}}" 
      on-response="_onResponse"><!-- userId id title body --></iron-ajax>

    <template is="dom-repeat" items="{{classes}}" as="item" initial-count="20">
      <paper-card heading="[[item.className]]" class="list-card">
        <div class="card-content"></div>
        <div class="card-actions">
          <paper-button on-tap="_viewClass">View</paper-button>
        </div>
      </paper-card>
    </template>

  </template>
  <script>
    Polymer({
      is:'class-list',
      properties : {
        classes : {
          type: Array,
          notify:true,
          value : []
        }
      }
      ,listeners : {
        'do-load-page' : '_loadPage'
      }
      ,_loadPage : function(e) {
        this.set('classes',[]);
        this.$.ajax.generateRequest();
      }
      ,_onResponse : function(e) {
        this.fire('page-ready');
      }
      ,_viewClass : function(e) {
        this.fire('load-page', { id: 'class-detail', item: e.model.item, title: e.model.item.title, backButton: true })
      }
      ,ready : function() {
        this.fire('component-loaded','class-list');
      }
    });
  </script>
</dom-module>
