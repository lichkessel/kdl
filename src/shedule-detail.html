<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">

<link rel="import" href="./owed-list.html">

<dom-module id="class-detail">
  <template>
    <style>
    </style>
    <iron-ajax auto 
      url="http://jsonplaceholder.typicode.com/posts/[[app.classKey]]" 
      last-response="{{sheduleDetail}}"
      last-error="{{error}}"
      loading="{{loadingDetail}}"><!-- userId id title body --></iron-ajax>

    <div hidden$="{{loadingDetail}}">{{sheduleDetail.body}}</div>

    <iron-ajax auto 
      url="http://jsonplaceholder.typicode.com/posts/[[app.classKey]]/comments" 
      last-response="{{classStudents}}"
      last-error="{{error}}"
      loading="{{loadingStudents}}"><!-- userId id title body --></iron-ajax>
    <div>
      <paper-spinner active$="{{loadingStudents}}"></paper-spinner>
      <ol hidden$="{{loadingStudents}}">
        <template is="dom-repeat" items="{{classStudents}}" >
          <li>
            <div>[[item.name]]</div>
            <button on-click="_toggleOwed">toggle</button>
            <div hidden$="{{!item.expanded}}">
              <owed-list student-id="{{item.id}}" expanded="{{item.expanded}}"></owed-list>
            </div>
           </li>
        </template>
      </ol>
    </div>
  </template>
  <script>
    Polymer({
      is : "class-detail",
      properties : {
        app : {
          type : Object,
          notify : true
        }
      },
      _toggleOwed : function(e) {
        e.model.set('item.expanded', !e.model.item.expanded);
      }
    });
  </script>
</dom-module>